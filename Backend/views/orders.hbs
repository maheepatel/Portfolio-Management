<!DOCTYPE html>
<html lang="en">
{{> header}}

<body>
  {{!-- {{> navbar }} --}}
<div>
  {{> sidebar}}
</div>

  <div class="order-table">

  <div class="order-input">
    {{!-- <div id="orders"> --}}
      <h2>For orders</h2>
      <form action="/orders" method="post">
      {{!-- <div class="data">
        <label for="user">User Id:</label>
        <input type="number" name="user_id" id="user_id">
      </div> --}}
      {{!-- <div class="data">
        <label for="order_id">Order Id:</label>
        <input type="number" name="order_id" id="order_id">
      </div> --}}
      <div class="data">
        <label for="stock_symbol">Stock Symbol:</label>
        <input type="text" name="stock_symbol" id="stock_symbol" pattern="[A-Z]+">
      </div>
      <div class="data">
        <label for="order_type">Order Type:</label>
        <input type="text" name="order_type" id="order_type">
      </div>
      <div class="data">
        <label for="purchase_price">Purchase Price:</label>
        <input type="number" name="purchase_price" id="purchase_price" step="0.01" min="0">
      </div>
      <div class="data">
        <label for="shares">Shares:</label>
        <input type="number" name="shares" id="shares">
      </div>
        <div class="btn">
          <button type="submit">Submit Order</button>
        </div>
      </form>
      {{!--
    </div> --}}
  </div>
  <hr>
    <h1 class="mt-4 mb-4 text-center text-primary">User's Orders</h1>
    <div class="order-table-output">
      <table class="table table-striped table-bordered">
        <tr>
          <th>User_Id</th>
          <th>Order_Id</th>
          <th>Stock_Symbol</th>
          <th>Order_Type</th>
          <th>@ Price</th>
          <th>Shares</th>
          <th>Action</th>
        </tr>
        {{#each order}}
        <tr>
          <td>{{USER_ID}}</td>
          <td>{{ORDER_ID}}</td>
          <td>{{STOCK_SYMBOL}}</td>
          <td>{{ORDER_TYPE}}</td>
          <td>{{PURCHASE_PRICE}}</td>
          <td>{{SHARES}}</td>
          <td>
            <a href="/orders/delete/{{STOCK_SYMBOL}}"
           class="btn btn-danger btn-sm">Delete</a>
          </td> 
        </tr>
        {{/each}}
      </table>
    </div>


  </div>


<script>
function deleteOrder(orderId, row) {
  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/orders');
  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
  xhr.onload = function() {
    if (xhr.status === 200) {
      // Remove the row from the table
      row.parentNode.removeChild(row);
    } else {
      console.log('Error: ' + xhr.status);
    }
  };
  xhr.send('order_id=' + encodeURIComponent(orderId));
}

window.addEventListener('load', function() {
  var deleteButtons = document.querySelectorAll('.delete-button');
  for (var i = 0; i < deleteButtons.length; i++) {
    deleteButtons[i].addEventListener('click', function() {
      var orderId = this.getAttribute('data-order-id');
      var row = this.parentNode.parentNode;
      deleteOrder(orderId, row);
    });
  }
});
</script>
</body>

</html>



{{!-- <td>{{order.[i].ORDER_ID}}</td>
<td>{{order.[i].STOCK_SYMBOL}}</td>
<td>{{order.[i].ORDER_TYPE}}</td>
<td>{{order.[i].ORDER_ID}}</td>
<td>{{order.[i].SHARES}}</td> --}}